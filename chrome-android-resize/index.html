<!DOCTYPE html>
<html>
  <head>
    <style>
      body {
        background-color: white;
        transition: 1s;
      }
      .flash {
        background-color: red;
        transition: none;
      }
    </style>
    <script>
      window.addEventListener('resize', function () {
        document.body.className = 'flash';
        var a = document.body.scrollHeight;  //repaint with the class in
        document.body.className = '';
        var a = document.body.scrollHeight;  //repaint with the class out
      });
    </script>
  </head>
  <body>
    <h1>Chrome on Android window resize events test page</h1>
    <p>In Chrome on Android, the browser will fire window resize events after the browser's location bar appears or disappears.  The page needs to scroll down a bit before this happens.</p>
    <p>Which is great.  More space!</p>
    <p>But if you use https and a self-signed or otherwise invalid certificate, Chrome will never hide the bar.</p>
    <p>Which is great too.  More security!</p>
    <h1>Why is this a problem?</h1>
    <p>Because it is very common to use self-signed certificates during development and/or testing, and use a proper certificate in production.</p>
    <p>Your production and testing environments are different!  Uh-oh.</p>
    <ul><li>Did you measure the size of the window adn use it in some media query? The actual size may change.</li>
    <li>Do you react to resize events for anything? Like, trying to detect screen orientation change?  Did you take into consideration that there may be resize events unrelated to orientation changes?</li>
    </ul>
    <h1>What does this page do, anyway?</h1>
    <p>Be long enough that it will scroll in a phone and tablet.  For some reason, the location bar only disappears after scrolling down more than a certain ammount.</p>
    <p>Every time there is a resize event, the background color of the page will change.</p>
    <h1>What about that self-signed certificate? Now I want to check it out too!</h1>
    <p>Glad you asked.  Here is some test page that will do the trick: <a href="https://www.pcwebshop.co.uk/">https://www.pcwebshop.co.uk/</a></p>
    <p>I found it here: <a href="https://onlinessl.netlock.hu/en/test-center/self-signed-ssl-certificate.html">https://onlinessl.netlock.hu/en/test-center/self-signed-ssl-certificate.html</a>.</p>
    <h1>So what do we do?</h1>
    <p>Not much you can do, except being aware of it and code your site properly.  This is the browser behaving as it should.</p>
    <p>Does it work for your device? It doesn't? Any feedback is appreciated. <a href="mailto:victor.rodriguez.gil@gmail.com">victor.rodriguez.gil@gmail.com</a></p>
    <h1>Space-wasting apendix</h1>
    <p>For those interested, and to make this page that little bit longer and make it scroll enough in my Nexus 7, here's the CSS and JavaScript that makes it do its thing:</p>
    <code>
      <pre>
      body {
        background-color: white;
        transition: 1s;
      }
      .flash {
        background-color: red;
        transition: none;
      }
      </pre>
    </code>
    <code>
      <pre>
      window.addEventListener('resize', function () {
        document.body.className = 'flash';
        var a = document.body.scrollHeight;  //repaint with the class in
        document.body.className = '';
        var a = document.body.scrollHeight;  //repaint with the class out
      });
      </pre>
    </code>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
    <p>I ran out of stuff to say and still the location bar doesn't hide in my Nexus 7.  I give up, I'm going to repeat this last paragraph of text until it does.</p>
  </body>
</html>
